<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="day6-用Python解决各种工作问题, Hexo">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>day6-用Python解决各种工作问题 | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 6.2.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/13.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">day6-用Python解决各种工作问题</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Python/">
                                <span class="chip bg-color">Python</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-05-14
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h3 id="本文章为金角大王Alex《Python零基础到精通7天速成》视频笔记"><a href="#本文章为金角大王Alex《Python零基础到精通7天速成》视频笔记" class="headerlink" title="本文章为金角大王Alex《Python零基础到精通7天速成》视频笔记"></a>本文章为金角大王Alex《Python零基础到精通7天速成》视频笔记</h3><h3 id="视频链接-Python零基础到精通7天速成"><a href="#视频链接-Python零基础到精通7天速成" class="headerlink" title="视频链接:Python零基础到精通7天速成"></a>视频链接:<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Gf4y1q7SG?share_source=copy_web">Python零基础到精通7天速成</a></h3><span id="more"></span>
<h1 id="一、模块和包"><a href="#一、模块和包" class="headerlink" title="一、模块和包"></a>一、模块和包</h1><h2 id="（一）什么是模块"><a href="#（一）什么是模块" class="headerlink" title="（一）什么是模块"></a>（一）什么是模块</h2><p>&amp;emsp;&amp;emsp;在计算机程序的开发过程中，随着程序代码越写越多，在⼀个⽂件⾥代码就会越来越⻓，越来越不容易维护。<br>&amp;emsp;&amp;emsp;<font color="#dd0000">为了编写可维护的代码</font>，我们把很多代码按功能分组，分别放到不同的⽂件⾥，这样，每个⽂件包含的代码就相对较少，很多编程语⾔都采⽤这种组织代码的⽅式。<font color="#dd0000">在Python中，⼀个.py⽂件就可以称之为⼀个模块（Module）</font></p>
<h4 id="使用模块有什么好处"><a href="#使用模块有什么好处" class="headerlink" title="使用模块有什么好处"></a>使用模块有什么好处</h4><p>&amp;emsp;&amp;emsp;最⼤的好处是<font color="#dd0000">⼤⼤提⾼了代码的可维护性</font>。其次，编写代码不必从零开始。<font color="#dd0000">当⼀个模块编写完毕，就可以被其他地⽅引⽤。</font>我们在编写程序的时候，也经常引⽤其他模块，包括Python内置的模块和来⾃第三⽅的模块。</p>
<p>&amp;emsp;&amp;emsp;<font color="#dd0000">使⽤模块还可以避免函数名和变量名冲突。</font> 每个模块有独⽴的命名空间，因此相同名字的函数和变量完全可以分别存在不同的模块中，所以，我们⾃⼰在编写模块时，不必考虑名字会与其他模块冲突</p>
<h4 id="模块的分类"><a href="#模块的分类" class="headerlink" title="模块的分类"></a>模块的分类</h4><p>1、内置标准模块（⼜称标准库）执⾏<font color="#dd0000">help(‘modules’)</font>查看所有python⾃带模块列表<br>2、第三⽅开源模块，可通过pip install 模块名联⽹安装<br>3、⾃定义模块</p>
<h4 id="模块调用"><a href="#模块调用" class="headerlink" title="模块调用"></a>模块调用</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> module_a <span class="token comment">#导⼊</span>
<span class="token keyword">from</span> module <span class="token keyword">import</span> xx <span class="token comment"># 导⼊某个模块下的某个⽅法 or ⼦模块</span>
<span class="token keyword">from</span> module<span class="token punctuation">.</span>xx<span class="token punctuation">.</span>xx <span class="token keyword">import</span> xx <span class="token keyword">as</span> rename <span class="token comment">#导⼊后⼀个⽅法后重命名</span>
<span class="token keyword">from</span> module<span class="token punctuation">.</span>xx<span class="token punctuation">.</span>xx <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#导⼊⼀个模块下的所有⽅法，不建议使⽤</span>
module_a<span class="token punctuation">.</span>xxx <span class="token comment">#调⽤</span></code></pre>
<p>※ 注意：<font color="#dd0000">模块⼀旦被调⽤，即相当于执⾏了另外⼀个py⽂件⾥的代码</font></p>
<h2 id="（二）自定义模块"><a href="#（二）自定义模块" class="headerlink" title="（二）自定义模块"></a>（二）自定义模块</h2><p>&amp;emsp;&amp;emsp;这个最简单， 创建⼀个.py⽂件，就可以称之为模块，就可以在另外⼀个程序⾥导⼊</p>
<div align=center>
<img src="https://img-blog.csdnimg.cn/68ed3adc3b70448fb63a27a232db1868.png" width = 80%>
</div>

<h2 id="（六）模块查找路径"><a href="#（六）模块查找路径" class="headerlink" title="（六）模块查找路径"></a>（六）模块查找路径</h2><p>&amp;emsp;&amp;emsp;Python导入模块时会自动在系统环境变量中寻找需要导入的模块或包，如果找不到就会报错。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys

<span class="token comment"># def sayhi():</span>
<span class="token comment">#     print('我是被调用的')</span>
<span class="token comment"># </span>
<span class="token comment"># print('哈哈哈哈')</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
<span class="token comment"># output:</span>
<span class="token comment"># ['C:\\Users\\Geng\\Desktop\\我在b站学编程\\python\\day6', </span>
<span class="token comment">#  'C:\\Users\\Geng\\Desktop\\我在b站学编程\\python', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\python39.zip', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\DLLs', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages', </span>
<span class="token comment">#  'C:\\Program Files (x86)\\ArcGIS\\Desktop10.6\\bin', </span>
<span class="token comment">#  'C:\\Program Files (x86)\\ArcGIS\\Desktop10.6\\ArcPy', </span>
<span class="token comment">#  'C:\\Program Files (x86)\\ArcGIS\\Desktop10.6\\ArcToolBox\\Scripts', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\locket-0.2.1-py3.9.egg', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\win32', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\win32\\lib', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\Pythonwin']</span></code></pre>
<h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><div align=center>
<img src="https://img-blog.csdnimg.cn/cd5052f2b00348f9a75a43e62528a000.png" width = 50%>
</div>
&emsp;&emsp;使用绝对导入的方法在day6课件下的import_test模块中导入my_first_mode模块。

<h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>1、先获取到import_test模块的所有系统环境变量（sys.path()），发现不包括day6<br>2、将其绝对路径向上移动一层到day6后并添加到系统环境变量中</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">)</span>  <span class="token comment"># 打印文件的调用路径列表，发现my_first_mode所在的day6文件夹并不在调用列表中</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>  <span class="token comment"># 打印当前模块绝对位置</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 打印当前位置的上一层（课件）</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 打印当前位置的上二层（day6）</span>

base_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 因为my_first_mode在day6文件夹</span>
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>base_path<span class="token punctuation">)</span>
<span class="token keyword">import</span> my_first_mode</code></pre>
<h2 id="（七）第三方开源模块"><a href="#（七）第三方开源模块" class="headerlink" title="（七）第三方开源模块"></a>（七）第三方开源模块</h2><p>&amp;emsp;&amp;emsp;<a target="_blank" rel="noopener" href="https://pypi.org/">https://pypi.org/</a> 是python的开源模块库，截⽌2022年5.15⽇，已经收录了375,660个来⾃全世界python开发者贡献的模块,⼏乎涵盖了你想⽤python做的任何事情。 事实上每个python开发者，只要注册⼀个账号就可以往这个平台上传你⾃⼰的模块，这样全世界的开发者都可以容易的下载并使⽤你的模块。</p>
<h4 id="下载方法"><a href="#下载方法" class="headerlink" title="下载方法"></a>下载方法</h4><p>1、 直接在上⾯这个⻚⾯上点download,下载后，解压并进⼊⽬录，执⾏以下命令完成安装</p>
<pre class="language-python" data-language="python"><code class="language-python">编译源码
python setup<span class="token punctuation">.</span>py build 
安装源码
python setup<span class="token punctuation">.</span>py install</code></pre>
<p>2、直接通过pip安装</p>
<pre class="language-python" data-language="python"><code class="language-python">pip3 install paramiko <span class="token comment">#paramiko 是模块名</span></code></pre>
<p>pip命令会⾃动下载模块包并完成安装。软件⼀般会被⾃动安装你python安装⽬录的这个⼦⽬录⾥</p>
<pre class="language-none"><code class="language-none">&#x2F;your_python_install_path&#x2F;3.6&#x2F;lib&#x2F;python3.6&#x2F;site-packages</code></pre>
<p>&amp;emsp;&amp;emsp;pip命令默认会连接在国外的python官⽅服务器下载，速度⽐较慢，你还可以使⽤国内的⾖瓣源，数据会定期同步国外官⽹，速度快好多</p>
<pre class="language-none"><code class="language-none">pip install -i http:&#x2F;&#x2F;pypi.douban.com&#x2F;simple&#x2F; alex_sayhi --trusted-host
pypi.douban.com #alex_sayhi是模块名</code></pre>
<p>-i 后⾯跟的是⾖瓣源地址</p>
<pre class="language-—trusted-host" data-language="—trusted-host"><div class="caption"><span>```得加上，是通过⽹站https安全验证⽤的</span></div><code class="language-—trusted-host">

## （三）什么是包
&amp;emsp;&amp;emsp;若你写的项⽬较复杂，有很多代码⽂件的话，为了⽅便管理，可以⽤包来管理。 &lt;font color&#x3D;&quot;#dd0000&quot;&gt;**⼀个包其实就是⼀个⽂件⽬录，**&lt;&#x2F;font&gt;你可以把属于同⼀个业务线的代码⽂件都放在同⼀个包⾥。
#### 如何创建包
&amp;emsp;&amp;emsp;只需要&lt;font color&#x3D;&quot;#dd0000&quot;&gt;**在⽬录下创建⼀个空的 __init__.py ⽂件 ，**&lt;&#x2F;font&gt; 这个⽬录就变成了包。这个⽂件叫包的初始化⽂件，⼀般为空，当然也可以写东⻄，&lt;font color&#x3D;&quot;#dd0000&quot;&gt;**当你调⽤这个包下及其任意⼦包的的任意模块时， 这个 __init__.py ⽂件都会先执⾏。**&lt;&#x2F;font&gt;

#### 示例
以下有a、b 2个包，a2是a的⼦包，b2是b的⼦包
&lt;div align&#x3D;center&gt;
&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;3c9cda86f9a344789f214b6872685226.png&quot; width &#x3D; 50%&gt;
&lt;&#x2F;div&gt;

#### 若在a_module.py模块⾥导⼊b2_mod.py的话，怎么办？
&amp;emsp;&amp;emsp;a_module.py的⽂件路径为：
&#96;&#96;&#96;python
print(__file__)
# output: C:\Users\Geng\Desktop\我在b站学编程\python\day6\课件\a\a2\a_module.py</code></pre>
<p>&amp;emsp;&amp;emsp;想导⼊成功，直接写以下代码就可以</p>
<pre class="language-none"><code class="language-none">from day6.课件.b.b2 import b2_mod</code></pre>
<p>&amp;emsp;&amp;emsp;为何从day6开始？⽽不是从 python 或课件开始呢？<br>&amp;emsp;&amp;emsp;因为你的系统环境变量（sys.path()）列表⾥，已经添加了顶级包（python）的路径.<font color="#dd0000"><strong>pycharm会自动将该模块所在位置和该模块的顶级包加入sys.path</strong></font></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
<span class="token comment"># output: </span>
<span class="token comment"># ['C:\\Users\\Geng\\Desktop\\我在b站学编程\\python\\day6\\课件\\a\\a2',</span>
<span class="token comment">#  'C:\\Users\\Geng\\Desktop\\我在b站学编程\\python',  # 就是这个啦</span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\python39.zip', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\DLLs', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages',</span>
<span class="token comment">#  'C:\\Program Files (x86)\\ArcGIS\\Desktop10.6\\bin', </span>
<span class="token comment">#  'C:\\Program Files (x86)\\ArcGIS\\Desktop10.6\\ArcPy', </span>
<span class="token comment">#  'C:\\Program Files (x86)\\ArcGIS\\Desktop10.6\\ArcToolBox\\Scripts', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\locket-0.2.1-py3.9.egg', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\win32', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\win32\\lib', </span>
<span class="token comment">#  'C:\\Users\\Geng\\anaconda3\\lib\\site-packages\\Pythonwin']</span>
</code></pre>
<h1 id="二、常用模块-os-amp-sys"><a href="#二、常用模块-os-amp-sys" class="headerlink" title="二、常用模块-os&amp;sys"></a>二、常用模块-os&amp;sys</h1><h2 id="（一）系统调⽤OS模块"><a href="#（一）系统调⽤OS模块" class="headerlink" title="（一）系统调⽤OS模块"></a>（一）系统调⽤OS模块</h2><p>&amp;emsp;&amp;emsp;os 模块提供了很多允许你的程序与操作系统直接交互的功能</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os
得到当前⼯作⽬录，即当前Python脚本⼯作的⽬录路径<span class="token punctuation">:</span> os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span>
返回指定⽬录下的所有⽂件和⽬录名<span class="token punctuation">:</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token punctuation">)</span>
函数⽤来删除⼀个⽂件<span class="token punctuation">:</span>os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token punctuation">)</span>
删除多个⽬录：os<span class="token punctuation">.</span>removedirs（r“c：\python”）
检验给出的路径是否是⼀个⽂件：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token punctuation">)</span>
检验给出的路径是否是⼀个⽬录：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span><span class="token punctuation">)</span>
判断是否是绝对路径：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isabs<span class="token punctuation">(</span><span class="token punctuation">)</span>
检验给出的路径是否真地存<span class="token punctuation">:</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span>
返回⼀个路径的⽬录名和⽂件名<span class="token punctuation">:</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span> e<span class="token punctuation">.</span>g
os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/home/swaroop/byte/code/poem.txt'</span><span class="token punctuation">)</span> 结果：
<span class="token punctuation">(</span><span class="token string">'/home/swaroop/byte/code'</span><span class="token punctuation">,</span> <span class="token string">'poem.txt'</span><span class="token punctuation">)</span>
分离扩展名：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span><span class="token punctuation">)</span> e<span class="token punctuation">.</span>g os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span><span class="token string">'/usr/local/test.py'</span><span class="token punctuation">)</span>
 结果：<span class="token punctuation">(</span><span class="token string">'/usr/local/test'</span><span class="token punctuation">,</span> <span class="token string">'.py'</span><span class="token punctuation">)</span>
获取路径名：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span><span class="token punctuation">)</span>
获得绝对路径<span class="token punctuation">:</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token punctuation">)</span>
获取⽂件名：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span><span class="token punctuation">)</span>
运⾏shell命令<span class="token punctuation">:</span> os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token punctuation">)</span>
读取操作系统环境变量HOME的值<span class="token punctuation">:</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"HOME"</span><span class="token punctuation">)</span>
返回操作系统所有的环境变量： os<span class="token punctuation">.</span>environ
设置系统环境变量，仅程序运⾏时有效：os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'HOME'</span><span class="token punctuation">,</span><span class="token string">'/home/alex'</span><span class="token punctuation">)</span>
给出当前平台使⽤的⾏终⽌符<span class="token punctuation">:</span>os<span class="token punctuation">.</span>linesep Windows使⽤<span class="token string">'\r\n'</span>，Linux <span class="token keyword">and</span> MAC使⽤<span class="token string">'\n'</span>
指示你正在使⽤的平台：os<span class="token punctuation">.</span>name 对于Windows，它是<span class="token string">'nt'</span>，⽽对于Linux<span class="token operator">/</span>Unix⽤户，它
是<span class="token string">'posix'</span>
重命名：os<span class="token punctuation">.</span>rename（old， new）
创建多级⽬录：os<span class="token punctuation">.</span>makedirs（r“c：\python\test”）
创建单个⽬录：os<span class="token punctuation">.</span>mkdir（“test”）
获取⽂件属性：os<span class="token punctuation">.</span>stat（<span class="token builtin">file</span>）
修改⽂件权限与时间戳：os<span class="token punctuation">.</span>chmod（<span class="token builtin">file</span>）
获取⽂件⼤⼩：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize（filename）
结合⽬录名与⽂件名：os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">,</span>filename<span class="token punctuation">)</span>
改变⼯作⽬录到dirname<span class="token punctuation">:</span> os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>dirname<span class="token punctuation">)</span>
获取当前终端的⼤⼩<span class="token punctuation">:</span> os<span class="token punctuation">.</span>get_terminal_size<span class="token punctuation">(</span><span class="token punctuation">)</span>
杀死进程<span class="token punctuation">:</span> os<span class="token punctuation">.</span>kill<span class="token punctuation">(</span><span class="token number">10884</span><span class="token punctuation">,</span>signal<span class="token punctuation">.</span>SIGKILL<span class="token punctuation">)</span></code></pre>
<h2 id="（二）sys模块"><a href="#（二）sys模块" class="headerlink" title="（二）sys模块"></a>（二）sys模块</h2><h4 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h4><pre class="language-python" data-language="python"><code class="language-python">sys<span class="token punctuation">.</span>path<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 以列表形式返回系统环境变量</span>
sys<span class="token punctuation">.</span>argv<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取脚本参数</span></code></pre>

<h1 id="三、常用模块-time-amp-datetime"><a href="#三、常用模块-time-amp-datetime" class="headerlink" title="三、常用模块-time&amp;datetime"></a>三、常用模块-time&amp;datetime</h1><h2 id="（一）基本概念"><a href="#（一）基本概念" class="headerlink" title="（一）基本概念"></a>（一）基本概念</h2><p>&amp;emsp;&amp;emsp;在平常的代码中，我们常常需要与时间打交道。在Python中，与时间处理有关的模块就包括：time，datetime,calendar(很少⽤，不讲)，下⾯分别来介绍。</p>
<h4 id="写程序时对时间的处理可以归为以下3种："><a href="#写程序时对时间的处理可以归为以下3种：" class="headerlink" title="写程序时对时间的处理可以归为以下3种："></a>写程序时对时间的处理可以归为以下3种：</h4><p><strong>时间的显示</strong>，在屏幕显示、记录⽇志等 “2022-03-04”<br><strong>时间的转换</strong>，⽐如把字符串格式的⽇期转成Python中的⽇期类型<br><strong>时间的运算</strong>，计算两个⽇期间的差值等</p>
<h4 id="在Python中，通常有这⼏种⽅式来表示时间："><a href="#在Python中，通常有这⼏种⽅式来表示时间：" class="headerlink" title="在Python中，通常有这⼏种⽅式来表示时间："></a>在Python中，通常有这⼏种⽅式来表示时间：</h4><p><strong>1. 时间戳（timestamp）</strong>, 表示的是从1970年1⽉1⽇00:00:00开始按秒计算的偏移量，<font color="#dd0000"><strong>用于时间的计算。</strong></font>例⼦：1554864776.161901<br><strong>2. 格式化的时间字符串</strong>，⽐如“2020-10-03 17:54”<font color="#dd0000"><strong>用于时间的显示。</strong></font><br><strong>3. 时间对象：</strong>元组（struct_time）共九个元素，由于Python的time模块实现主要调⽤C库，所以各个平台可能有所不同，mac上：time.struct_time(tm_year&#x3D;2020, tm_mon&#x3D;4, tm_mday&#x3D;10, tm_hour&#x3D;2, tm_min&#x3D;53, tm_sec&#x3D;15, tm_wday&#x3D;2, tm_yday&#x3D;100, tm_isdst&#x3D;0)</p>
<pre class="language-python" data-language="python"><code class="language-python">索引（Index） 属性（Attribute） 值（Values）
<span class="token number">0</span> tm_year（年） ⽐如<span class="token number">2011</span>
<span class="token number">1</span> tm_mon（⽉） <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">12</span>
<span class="token number">2</span> tm_mday（⽇） <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">31</span>
<span class="token number">3</span> tm_hour（时） <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">23</span>
<span class="token number">4</span> tm_min（分） <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">59</span>
<span class="token number">5</span> tm_sec（秒） <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">61</span>
<span class="token number">6</span> tm_wday（weekday） <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">6</span>（<span class="token number">0</span>表示周⼀）
<span class="token number">7</span> tm_yday（⼀年中的第⼏天） <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">366</span>
<span class="token number">8</span> tm_isdst（是否是夏令时） 默认为<span class="token operator">-</span><span class="token number">1</span></code></pre>
<p><strong>UTC时间</strong><br>&amp;emsp;&amp;emsp;UTC（Coordinated Universal Time，世界协调时）亦即格林威治天⽂时间，世界标准时间。在中国为UTC+8，⼜称东8区。DST（Daylight Saving Time）即夏令时。</p>
<div align=center>
<img src="https://img-blog.csdnimg.cn/c4fba89d5c0e44ada45f43c4e18238c2.png" width = 80%>
</div>

<h2 id="（二）time模块的常⽤⽅法"><a href="#（二）time模块的常⽤⽅法" class="headerlink" title="（二）time模块的常⽤⽅法"></a>（二）time模块的常⽤⽅法</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> time

<span class="token comment"># 1、计算机中的时间：时间戳</span>
time_stamp <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>time_stamp<span class="token punctuation">)</span>  <span class="token comment"># output：1652668353.8377407</span>

<span class="token comment"># 2、将时间戳和时间对象的转化</span>
<span class="token comment"># 时间戳转为时间对象</span>
time_struct <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 将时间戳转化为时间对象</span>
time_struct_zero <span class="token operator">=</span> time<span class="token punctuation">.</span>gmtime<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 将时间戳转化为零时区的时间对象</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>time_struct<span class="token punctuation">)</span>  <span class="token comment"># output：time.struct_time(tm_year=2022, tm_mon=5, tm_mday=16, tm_hour=10, tm_min=25, tm_sec=57, tm_wday=0, tm_yday=136, tm_isdst=0)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>time_struct_zero<span class="token punctuation">)</span>  <span class="token comment"># output：time.struct_time(tm_year=2022, tm_mon=5, tm_mday=16, tm_hour=2, tm_min=25, tm_sec=57, tm_wday=0, tm_yday=136, tm_isdst=0)</span>
<span class="token comment"># 时间对象转为时间戳</span>
time_stamp1 <span class="token operator">=</span> time<span class="token punctuation">.</span>mktime<span class="token punctuation">(</span>time_struct<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>time_stamp1<span class="token punctuation">)</span>  <span class="token comment"># output: 1652668353.0</span>

<span class="token comment"># 3、时间对象和时间字符串的转化</span>
<span class="token comment"># 时间对象转化为时间字符串</span>
time_str <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>time_str<span class="token punctuation">)</span>  <span class="token comment"># 2022-05-16 10:34:15</span>
<span class="token comment"># 时间字符串转化为时间对象</span>
time_struct1 <span class="token operator">=</span> time<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>time_str<span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>time_struct1<span class="token punctuation">)</span>  <span class="token comment"># output:time.struct_time(tm_year=2022, tm_mon=5, tm_mday=16, tm_hour=10, tm_min=34, tm_sec=15, tm_wday=0, tm_yday=136, tm_isdst=-1)</span>

<span class="token comment"># 4、sleep</span>
s_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s_time<span class="token punctuation">)</span>  <span class="token comment"># output:1652670953.2851179</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
e_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>e_time<span class="token punctuation">)</span>  <span class="token comment"># output：1652670956.2869053</span></code></pre>
<h4 id="字符串转时间格式对应表"><a href="#字符串转时间格式对应表" class="headerlink" title="字符串转时间格式对应表"></a>字符串转时间格式对应表</h4><div align=center>
<img src="https://img-blog.csdnimg.cn/ebc2d679d63440f8b9ca4c545323846d.png" width = 80%>
</div>
<div align=center>
<img src="https://img-blog.csdnimg.cn/d6aee8de24f6464eab702e73657bac77.png" width = 80%>
</div>

<h4 id="最后为了容易记住转换关系，看下图"><a href="#最后为了容易记住转换关系，看下图" class="headerlink" title="最后为了容易记住转换关系，看下图"></a>最后为了容易记住转换关系，看下图</h4><div align=center>
<img src="https://img-blog.csdnimg.cn/d88a02b06aad491e9dd115a22bfcd822.png" width = 80%>
</div>

<h2 id="（三）datetime模块"><a href="#（三）datetime模块" class="headerlink" title="（三）datetime模块"></a>（三）datetime模块</h2><p>&amp;emsp;&amp;emsp;相⽐于time模块，datetime模块的接⼝则更直观、更容易调⽤</p>
<h4 id="datetime模块定义了下⾯这⼏个类："><a href="#datetime模块定义了下⾯这⼏个类：" class="headerlink" title="datetime模块定义了下⾯这⼏个类："></a>datetime模块定义了下⾯这⼏个类：</h4><pre class="language-python" data-language="python"><code class="language-python">datetime<span class="token punctuation">.</span>date： <span class="token comment"># 表示⽇期的类。常⽤的属性有year, month, day</span>
datetime<span class="token punctuation">.</span>time： <span class="token comment"># 表示时间的类。常⽤的属性有hour, minute, second, microsecond</span>
datetime<span class="token punctuation">.</span>datetime： <span class="token comment"># 表示⽇期时间</span>
datetime<span class="token punctuation">.</span>timedelta： <span class="token comment"># 表示时间间隔，即两个时间点之间的⻓度</span>
datetime<span class="token punctuation">.</span>tzinfo： <span class="token comment"># 与时区有关的相关信息。（这⾥不详细充分讨论该类，感兴趣的童鞋可以参考python⼿册）</span></code></pre>
<h4 id="我们需要记住的⽅法仅以下⼏个："><a href="#我们需要记住的⽅法仅以下⼏个：" class="headerlink" title="我们需要记住的⽅法仅以下⼏个："></a>我们需要记住的⽅法仅以下⼏个：</h4><pre class="language-python" data-language="python"><code class="language-python">d<span class="token operator">=</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 返回当前的datetime⽇期类型, d.timestamp(),d.today(),d.year,d.timetuple()等⽅法可以调⽤</span>
datetime<span class="token punctuation">.</span>date<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span><span class="token number">322222</span><span class="token punctuation">)</span>  <span class="token comment"># 把⼀个时间戳转为datetime⽇期类型</span></code></pre>
<h4 id="时间运算"><a href="#时间运算" class="headerlink" title="时间运算"></a><font color="#dd0000">时间运算</font></h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">821218</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">#当前时间 +4天</span>
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">276589</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span>hours<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">#当前时间+4⼩时</span>
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">876275</span><span class="token punctuation">)</span></code></pre>
<h4 id="时间替换"><a href="#时间替换" class="headerlink" title="时间替换"></a><font color="#dd0000">时间替换</font></h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> d<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>year<span class="token operator">=</span><span class="token number">2999</span><span class="token punctuation">,</span>month<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">,</span>day<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
datetime<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token number">2999</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span></code></pre>
<h1 id="四、常用模块-random"><a href="#四、常用模块-random" class="headerlink" title="四、常用模块-random"></a>四、常用模块-random</h1><p>&amp;emsp;&amp;emsp;程序中有很多地⽅需要⽤到随机字符，⽐如登录⽹站的随机验证码，通过random模块可以很容易⽣成随机字符串</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">#返回1-10之间的⼀个随机数，不包括10</span>
<span class="token operator">>></span><span class="token operator">></span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">#返回1-10之间的⼀个随机数，包括10</span>
<span class="token operator">>></span><span class="token operator">></span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#随机选取0到100间的偶数</span>
<span class="token operator">>></span><span class="token operator">></span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#返回⼀个随机浮点数</span>
<span class="token operator">>></span><span class="token operator">></span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token string">'abce3#$@1'</span><span class="token punctuation">)</span> <span class="token comment">#返回⼀个给定数据集合中的随机字符</span>
<span class="token string">'#'</span>
<span class="token operator">>></span><span class="token operator">></span> random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token string">'abcdefghij'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">#从多个字符中选取特定数量的字符</span>
<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span>
<span class="token comment">#⽣成随机字符串</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> string
<span class="token operator">>></span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token string">'4fvda1'</span>
<span class="token comment">#洗牌</span>
<span class="token operator">>></span><span class="token operator">></span> a
<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
<span class="token operator">>></span><span class="token operator">></span> random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> a
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span></code></pre>
<h1 id="五、常用模块-json序列"><a href="#五、常用模块-json序列" class="headerlink" title="五、常用模块-json序列"></a>五、常用模块-json序列</h1><h2 id="（一）概念"><a href="#（一）概念" class="headerlink" title="（一）概念"></a>（一）概念</h2><p>&amp;emsp;&amp;emsp;JSON(JavaScriptObject Notation, JS 对象简谱) 是⼀种轻量级的数据交换格式。它采⽤完全独⽴于编程<br>语⾔的⽂本格式来存储和表示数据。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语⾔。 易于⼈阅读和编写，同时也易于机器解析和⽣成，并有效地提升⽹络传输效率。</p>
<div align=center>
<img src="https://img-blog.csdnimg.cn/ca4b4eb7be0d4b6d98b0b08c4a6f384b.png" width = 80%>
</div>
&emsp;&emsp;Json的作⽤是⽤于不同语⾔接⼝间的数据交换，⽐如你把python的list、dict直接扔给javascript, 它是解析不了的。两个语⾔互相谁也不认识。Json就像是计算机界的英语 ，可以帮各个语⾔之间实现数据类型的相互转换。

<div align=center>
<img src="https://img-blog.csdnimg.cn/ec2fd65decbe488dada8c667ce3e1673.png" width = 80%>
</div>

<div align=center>
<img src="https://img-blog.csdnimg.cn/01d31de8b16646778a1ab4ceaa56d76d.png" width = 80%>
</div>

<h4 id="JSON⽀持的数据类型"><a href="#JSON⽀持的数据类型" class="headerlink" title="JSON⽀持的数据类型"></a>JSON⽀持的数据类型</h4><p>&amp;emsp;&amp;emsp;Python中的字符串、数字、列表、字典、集合、布尔类型，都可以被序列化成JSON字符串，被其它任何编程语⾔解析</p>
<h4 id="什么是序列化？"><a href="#什么是序列化？" class="headerlink" title="什么是序列化？"></a>什么是序列化？</h4><p>&amp;emsp;&amp;emsp;序列化是指把内存⾥的数据类型转变成字符串，以使其能存储到硬盘或通过⽹络传输到远程，因为硬盘或⽹络传输时只能接受bytes</p>
<h4 id="为什么要序列化？"><a href="#为什么要序列化？" class="headerlink" title="为什么要序列化？"></a>为什么要序列化？</h4><p>&amp;emsp;&amp;emsp;你打游戏过程中，打累了，停下来，关掉游戏、想过2天再玩，2天之后，游戏⼜从你上次停⽌的地⽅继续运⾏，你上次游戏的进度肯定保存在硬盘上了，是以何种形式呢？游戏过程中产⽣的很多临时数据是不规律的，可能在你关掉游戏时正好有10个列表，3个嵌套字典的数据集合在内存⾥，需要存下来？你如何存？把列表变成⽂件⾥的多⾏多列形式？那嵌套字典呢？根本没法存。所以，若是有种办法可以直接把内存数据存到硬盘上，下次程序再启动，再从硬盘上读回来，还是原来的格式的话，那是极好的。</p>
<h4 id="⽤于序列化的两个模块"><a href="#⽤于序列化的两个模块" class="headerlink" title="⽤于序列化的两个模块"></a>⽤于序列化的两个模块</h4><p>1、json，⽤于字符串和python数据类型间进⾏转换<br>2、pickle，⽤于python特有的类型和 python的数据类型间进⾏转换</p>
<h4 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h4><p>模块提供了四个功能：dumps、dump、loads、load</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pickle
data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'k1'</span><span class="token punctuation">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">'k2'</span><span class="token punctuation">:</span><span class="token string">'Hello'</span><span class="token punctuation">&#125;</span>
<span class="token comment"># pickle.dumps 将数据通过特殊的形式转换位只有python语⾔认识的字符串</span>
p_str <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment"># 注意dumps会把数据变成bytes格式</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p_str<span class="token punctuation">)</span>
<span class="token comment"># pickle.dump 将数据通过特殊的形式转换位只有python语⾔认识的字符串，并写⼊⽂件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'result.pk'</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
 pickle<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>data<span class="token punctuation">,</span>fp<span class="token punctuation">)</span>
<span class="token comment"># pickle.load 从⽂件⾥加载</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result.pk"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span></code></pre>
<h4 id="json"><a href="#json" class="headerlink" title="json"></a>json</h4><p>Json模块也提供了四个功能：dumps、dump、loads、load，⽤法跟pickle⼀致</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json
<span class="token comment"># json.dumps 将数据通过特殊的形式转换位所有程序语⾔都认识的字符串</span>
j_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment"># 注意json dumps⽣成的是字符串，不是bytes</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>j_str<span class="token punctuation">)</span>
<span class="token comment">#dump⼊⽂件</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'result.json'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>
 json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>data<span class="token punctuation">,</span>fp<span class="token punctuation">)</span>
<span class="token comment">#从⽂件⾥load</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"result.json"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
 d <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
 <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span></code></pre>
<h4 id="json-vs-pickle"><a href="#json-vs-pickle" class="headerlink" title="json vs pickle:"></a>json vs pickle:</h4><p><strong>json</strong><br>优点：跨语⾔(不同语⾔间的数据传递可⽤json交接)、体积⼩<br>缺点：只能⽀持int\str\list\tuple\dict<br><strong>Pickle</strong><br>优点：专为python设计，⽀持python所有的数据类型<br>缺点：只能在python中使⽤，存储数据占空间⼤</p>
<h1 id="六、常用模块-excel处理"><a href="#六、常用模块-excel处理" class="headerlink" title="六、常用模块-excel处理"></a>六、常用模块-excel处理</h1><p>&amp;emsp;&amp;emsp;第3⽅开源模块,安装</p>
<pre class="language-python" data-language="python"><code class="language-python">pip install openpyxl</code></pre>
<h2 id="（一）打开⽂件"><a href="#（一）打开⽂件" class="headerlink" title="（一）打开⽂件"></a>（一）打开⽂件</h2><h4 id="1、创建"><a href="#1、创建" class="headerlink" title="1、创建"></a>1、创建</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook
<span class="token comment"># 实例化</span>
wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 获取当前active的sheet</span>
ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>active
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token comment"># 打印sheet表名</span>
sheet<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"salary luffy"</span> <span class="token comment"># 改sheet 名</span></code></pre>

<h4 id="2、打开已有⽂件"><a href="#2、打开已有⽂件" class="headerlink" title="2、打开已有⽂件"></a>2、打开已有⽂件</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook
<span class="token operator">>></span><span class="token operator">></span> wb2 <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span><span class="token string">'⽂件名称.xlsx'</span><span class="token punctuation">)</span></code></pre>
<h2 id="（二）增删改查"><a href="#（二）增删改查" class="headerlink" title="（二）增删改查"></a>（二）增删改查</h2><h4 id="1、写数据"><a href="#1、写数据" class="headerlink" title="1、写数据"></a>1、写数据</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># ⽅式⼀：数据可以直接分配到单元格中(可以输⼊公式)</span>
sheet<span class="token punctuation">[</span><span class="token string">"C5"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Hello ⾦⻆⼤王"</span>
sheet<span class="token punctuation">[</span><span class="token string">"C7"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Hello ⾦⻆⼤王2"</span>
<span class="token comment"># ⽅式⼆：可以附加⾏，从第⼀列开始附加(从最下⽅空⽩处，最左开始)(可以输⼊多⾏)</span>
sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># ⽅式三：Python 类型会被⾃动转换</span>
sheet<span class="token punctuation">[</span><span class="token string">'A3'</span><span class="token punctuation">]</span> <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span></code></pre>

<h4 id="2、选择表"><a href="#2、选择表" class="headerlink" title="2、选择表"></a>2、选择表</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sheet 名称可以作为 key 进⾏索引</span>
ws3 <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">"New Title"</span><span class="token punctuation">]</span>
ws4 <span class="token operator">=</span> wb<span class="token punctuation">.</span>get_sheet_by_name<span class="token punctuation">(</span><span class="token string">"New Title"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>wb<span class="token punctuation">.</span>get_sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 打印所有的sheet</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>worksheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 获得第1个sheet</span></code></pre>

<h4 id="3、保存表"><a href="#3、保存表" class="headerlink" title="3、保存表"></a>3、保存表</h4><pre class="language-python" data-language="python"><code class="language-python">wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'⽂件名称.xlsx'</span><span class="token punctuation">)</span></code></pre>
<h4 id="4、删除工作表"><a href="#4、删除工作表" class="headerlink" title="4、删除工作表"></a>4、删除工作表</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># ⽅式⼀</span>
wb<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>sheet<span class="token punctuation">)</span>
<span class="token comment"># ⽅式⼆</span>
<span class="token keyword">del</span> wb<span class="token punctuation">[</span>sheet<span class="token punctuation">]</span></code></pre>

<h2 id="（三）花式遍历表数据"><a href="#（三）花式遍历表数据" class="headerlink" title="（三）花式遍历表数据"></a>（三）花式遍历表数据</h2><h4 id="1、按行遍历"><a href="#1、按行遍历" class="headerlink" title="1、按行遍历"></a>1、按行遍历</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">:</span> <span class="token comment"># 循环获取表数据</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span> <span class="token comment"># 循环获取每个单元格数据</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h4 id="2、按列遍历"><a href="#2、按列遍历" class="headerlink" title="2、按列遍历"></a>2、按列遍历</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># A1, A2, A3这样的顺序</span>
<span class="token keyword">for</span> column <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> column<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h4 id="3、遍历指定⾏-amp-列"><a href="#3、遍历指定⾏-amp-列" class="headerlink" title="3、遍历指定⾏&amp;列"></a>3、遍历指定⾏&amp;列</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 从第2⾏开始⾄第5⾏，每⾏打印5列</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>max_row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>max_col<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h4 id="4、遍历指定⼏列的数据-取得第2到第5列的数据"><a href="#4、遍历指定⼏列的数据-取得第2到第5列的数据" class="headerlink" title="4、遍历指定⼏列的数据-取得第2到第5列的数据"></a>4、遍历指定⼏列的数据-取得第2到第5列的数据</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> col <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_cols<span class="token punctuation">(</span>min_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>max_col<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> col<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>value<span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<h2 id="（四）设置单元格样式"><a href="#（四）设置单元格样式" class="headerlink" title="（四）设置单元格样式"></a>（四）设置单元格样式</h2><h4 id="1、需导⼊的类"><a href="#1、需导⼊的类" class="headerlink" title="1、需导⼊的类"></a>1、需导⼊的类</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Font<span class="token punctuation">,</span> colors<span class="token punctuation">,</span> Alignment</code></pre>

<h4 id="2、字体"><a href="#2、字体" class="headerlink" title="2、字体"></a>2、字体</h4><p>&amp;emsp;&amp;emsp;下⾯的代码指定了等线24号，加粗斜体，字体颜⾊红⾊。直接使⽤cell的font属性，将Font对象赋值给它。</p>
<pre class="language-python" data-language="python"><code class="language-python">bold_itatic_24_font <span class="token operator">=</span> Font<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'等线'</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span> italic<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">.</span>RED<span class="token punctuation">,</span>
bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 声明样式</span>
sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> bold_itatic_24_font <span class="token comment"># 给单元格设置样式</span></code></pre>
<h4 id="3、对齐方式"><a href="#3、对齐方式" class="headerlink" title="3、对齐方式"></a>3、对齐方式</h4><p>&amp;emsp;&amp;emsp;也是直接使⽤cell的属性aligment，这⾥指定垂直居中和⽔平居中。除了center，还可以使⽤right、left<br>等等参数。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置B1中的数据垂直居中和⽔平居中</span>
sheet<span class="token punctuation">[</span><span class="token string">'B1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> Alignment<span class="token punctuation">(</span>horizontal<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> vertical<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span></code></pre>

<h4 id="4、设置⾏⾼-amp-列宽"><a href="#4、设置⾏⾼-amp-列宽" class="headerlink" title="4、设置⾏⾼&amp;列宽"></a>4、设置⾏⾼&amp;列宽</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 第2⾏⾏⾼</span>
sheet<span class="token punctuation">.</span>row_dimensions<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">40</span>
<span class="token comment"># C列列宽</span>
sheet<span class="token punctuation">.</span>column_dimensions<span class="token punctuation">[</span><span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">30</span></code></pre>
<h2 id="（五）小练习"><a href="#（五）小练习" class="headerlink" title="（五）小练习"></a>（五）小练习</h2><h4 id="练习数据-iris"><a href="#练习数据-iris" class="headerlink" title="练习数据-iris"></a>练习数据-iris</h4><pre class="language-none"><code class="language-none">序号,sepal_length(cm),sepal_width(cm),petal_length(cm),petal_width(cm),outcome
0,5.1,3.5,1.4,0.2,o
1,4.9,3,1.4,0.2,0
2,4.7,3.2,1.3,0.2,0
3,4.6,31,1.5,0.2,0
4,5,3.6,1.4,0.2,0
5,5.4,3.9,1.7,0.4,0
6,4.6,3.4,1.4,0.3,0
7,5,3.4,1.5,0.2,0
8,4.4,2.9,1.4,0.2,0
9,4.9,3.1,1.5,0.1,0
10,5.4,3.7,1.5,0.2,0
11,4.8,3.4,1.6,0.2,0
12,4.8,3,1.4,0.1,0
13,4.3,3,1.1,0.1,0
14,5.8,4,1.2,0.2,0
15,5.7,4.4,1.5,0.4,0
16,5.4,3.9,1.3,0.4,0
17,5.1,3.5,1.4,0.3,0
18,5.7,3.8,1.7,0.3,0
19,5.1,3.8,1.5,0.3,0
20,5.4,3.4,1.7,0.2,0
21,5.1,3.7,1.5,0.4,0
22,4.6,3.6,1,0.2,0
23,5.1,3.3,1.7,0.5,0
24,4.8,3.4,1.9,0.2,0
25,5,3,1.6,0.2,0
26,5,3.4,1.6,0.4,0
27,5.2,3.5,1.5,0.2,0
28,5.2,3.4,1.4,0.2,0
29,4.7,3.2,1.6,0.2,0
30,4.8,3.1,1.6,0.2,0
31,5.4,3.4,1.5,0.4,0
32,5.2,4.1,1.5,0.1,0
33,5.5,4.2,1.4,0.2,0
34,4.9,3.1,1.5,0.2,0
35,5,3.2,1.2,0.2,0
36,5.5,3.5,1.3,0.2,0
37,4.9,3.6,1.4,0.1,0
38,4.4,3,1.3,0.2,0
39,5.1,3.4,1.5,0.2,0
40,5,3.5,1.3,0.3,0
41,4.5,2.3,1.3,0.3,0
42,4.4,3.2,1.3,0.2,0
43,5,3.5,1.6,0.6,0
44,5.1,3.8,1.9,0.4,0
45,4.8,3,1.4,0.3,0
46,5.1,3.8,1.6,0.2,0
47,4.6,3.2,1.4,0.2,0
48,5.3,3.7,1.5,0.2,0
49,5,3.3,1.4,0.2,0
50,7,3.2,4.7,1.4,1</code></pre>

<h4 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h4><p>1、创建iris.xlsx文件，导入上述数据<br>2、新增一行数据，51	6.4	3.2	4.5	1.5	1<br>3、将C5改为31,F2改为0<br>4、分别按行、按列遍历数据<br>5、获取第5行到第22行，C到E列的数据<br>6、将D9单元格字体设为新罗马24号，加粗斜体，字体颜⾊红⾊<br>7、将D9单元格指定垂直居中和⽔平居中</p>
<h4 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Font<span class="token punctuation">,</span> colors<span class="token punctuation">,</span> Alignment
<span class="token comment"># 1、创建iris.xlsx文件，导入数据</span>
<span class="token comment"># file_iris = open('iris', encoding='utf-8')</span>
<span class="token comment"># for line in file_iris:</span>

wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 实例化Workbook</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active  <span class="token comment"># 激活该sheet</span>
sheet<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'iris'</span>  <span class="token comment"># 更改sheet名称</span>

<span class="token comment"># 写入数据</span>
file_iris <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'iris'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> file_iris<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span>



<span class="token comment"># 2、新增一行数据，51	6.4	3.2	4.5	1.5	1</span>
sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'51'</span><span class="token punctuation">,</span> <span class="token string">'6.4'</span><span class="token punctuation">,</span> <span class="token string">'3.2'</span><span class="token punctuation">,</span> <span class="token string">'4.5'</span><span class="token punctuation">,</span> <span class="token string">'1.5'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 3、将C5改为3.1,F2改为0</span>
sheet<span class="token punctuation">[</span><span class="token string">'C5'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'3.1'</span>
sheet<span class="token punctuation">[</span><span class="token string">'F2'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0'</span>

<span class="token comment"># 4、分别按行、按列遍历数据</span>
<span class="token comment"># 按行</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 按列</span>
<span class="token keyword">for</span> col <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> col<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 5、获取第5行到第22行，C到E列的数据</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_cols<span class="token punctuation">(</span>min_row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 6、将D9单元格字体设为新罗马24号，加粗斜体，字体颜⾊红⾊</span>

my_style <span class="token operator">=</span> Font<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Times New Roman'</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span> italic<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> color<span class="token operator">=</span>colors<span class="token punctuation">.</span>COLOR_INDEX<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 声明样式</span>
sheet<span class="token punctuation">[</span><span class="token string">'D9'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> my_style

<span class="token comment"># 将D9单元格指定垂直居中和⽔平居中</span>
sheet<span class="token punctuation">[</span><span class="token string">'D9'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> Alignment<span class="token punctuation">(</span>horizontal<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> vertical<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>

<span class="token comment"># 保存文件</span>
wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'iris.xlsx'</span><span class="token punctuation">)</span></code></pre>
<h1 id="七、常用模块-邮件发送"><a href="#七、常用模块-邮件发送" class="headerlink" title="七、常用模块-邮件发送"></a>七、常用模块-邮件发送</h1><p>&amp;emsp;&amp;emsp;SMTP（Simple Mail Transfer Protocol）即简单邮件传输协议,它是⼀组⽤于由源地址到⽬的地址传送<br>邮件的规则，由它来控制信件的中转⽅式。</p>
<div align=center>
<img src="https://img-blog.csdnimg.cn/7376ab924d6c4cde93a5a37608acc310.png" width = 80%>
</div>

<h4 id="想实现发送邮件需经过以下⼏步："><a href="#想实现发送邮件需经过以下⼏步：" class="headerlink" title="想实现发送邮件需经过以下⼏步："></a>想实现发送邮件需经过以下⼏步：</h4><p>1、登录 邮件服务器<br>2、构造符合邮件协议规则要求的邮件内容 （email模块）<br>3、发送<br>&amp;emsp;&amp;emsp;Python对SMTP⽀持有smtplib 和 email 两个模块， email 负责构造邮件， smtplib 负责发送邮件,它对smtp协议进⾏了简单的封装。</p>
<h4 id="发送⼀封最简单的信语法如下："><a href="#发送⼀封最简单的信语法如下：" class="headerlink" title="发送⼀封最简单的信语法如下："></a>发送⼀封最简单的信语法如下：</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> smtplib
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText  <span class="token comment"># 构造邮件正文</span>
<span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header  <span class="token comment"># 邮件头</span>

<span class="token comment"># 登录邮件服务器</span>
smtp_obj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span><span class="token string">"smtp.qq.com"</span><span class="token punctuation">,</span> <span class="token number">465</span><span class="token punctuation">)</span>  <span class="token comment"># 发件⼈邮箱中的SMTP服务器，端⼝是25</span>
smtp_obj<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token string">"xxxxxxxxxx@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"bvidphbzxnsjjdch"</span><span class="token punctuation">)</span>  <span class="token comment"># 括号中对应的是发件⼈邮箱账号、邮箱密码</span>
<span class="token comment"># smtp_obj.set_debuglevel(1) # 显示调试信息</span>

<span class="token comment"># 设置邮件头信息</span>
msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span><span class="token string">"xxxxxxxxxxx"</span><span class="token punctuation">,</span> <span class="token string">"plain"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># plain表示文件内容为纯文本</span>
msg<span class="token punctuation">[</span><span class="token string">"From"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"xxxxxxxx"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># 发送者</span>
msg<span class="token punctuation">[</span><span class="token string">"To"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"xxxxxx"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># 接收者</span>
msg<span class="token punctuation">[</span><span class="token string">"Subject"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># 主题</span>

<span class="token comment"># 发送</span>
smtp_obj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span><span class="token string">"xxxxxxxxx@qq.com"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"xxxxxxxxxx@qq.com"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 接受方可使用列表同时传入多个值</span></code></pre>
<p>※ 如何查看发送邮件服务器-以QQ邮箱为例：<br>1、点击设置-账户</p>
<div align=center>
<img src="https://img-blog.csdnimg.cn/a752685766854b2f8e18af011e4831a2.png" width = 80%>
</div>
2、IMAP/SMTP服务-点击什么是 IMAP，它又是如何设置？
<div align=center>
<img src="https://img-blog.csdnimg.cn/a403ea4074b8419ba563ee0992f064dd.png" width = 80%>
</div>
3、进入页面
<div align=center>
<img src="https://img-blog.csdnimg.cn/7ca6edb3f0b9412e81fea294e32d0eb9.png" width = 80%>
</div>

<p>※ 如何查看发送邮件服务器-以QQ邮箱为例：msg的[“From”]、[“To”]和[“Subject”]为邮件显示的发送者，接受者和主题，可以自定义smtp_obj.sendmail()中才传入发送方、接收方和内容。</p>
<div align=center>
<img src="https://img-blog.csdnimg.cn/3481f353c4a445a290d2eecfb41f8531.png" width = 80%>
</div>

<h4 id="发送HTML格式的邮件"><a href="#发送HTML格式的邮件" class="headerlink" title="发送HTML格式的邮件"></a>发送HTML格式的邮件</h4><p>&amp;emsp;&amp;emsp;只需要改⼀下 MIMEText() 第2个参数为 html 就可以</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置邮件头信息</span>
mail_body <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
 &lt;h5>hello,⼩哥哥&lt;/h5>
 &lt;p>
 你好同学 &lt;a
href="http://wx1.sinaimg.cn/mw1024/5ff6135fgy1gdnghz2vbsg205k09ob2d.gif">这是我
的照⽚&lt;/a>&lt;/p>
 &lt;/p>
'''</span>
msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>mail_body<span class="token punctuation">,</span> <span class="token string">"html"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span></code></pre>

<h4 id="在HTML⽂本中插⼊图⽚"><a href="#在HTML⽂本中插⼊图⽚" class="headerlink" title="在HTML⽂本中插⼊图⽚"></a>在HTML⽂本中插⼊图⽚</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token comment"># created by Alex Li - 路⻜学城</span>
<span class="token keyword">import</span> smtplib
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>image <span class="token keyword">import</span> MIMEImage
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>multipart <span class="token keyword">import</span> MIMEMultipart
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText
<span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header
<span class="token comment"># 登录邮件服务器</span>
smtp_obj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span><span class="token string">"smtp.exmail.qq.com"</span><span class="token punctuation">,</span> <span class="token number">465</span><span class="token punctuation">)</span> <span class="token comment"># 发件⼈邮箱中的SMTP服务</span>
器，端⼝是<span class="token number">25</span>
smtp_obj<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token string">"nami@luffycity.com"</span><span class="token punctuation">,</span> <span class="token string">"333dsfsf#$#"</span><span class="token punctuation">)</span> <span class="token comment"># 括号中对应的是发件⼈邮箱账</span>
号、邮箱密码
smtp_obj<span class="token punctuation">.</span>set_debuglevel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 显示调试信息</span>
<span class="token comment"># 设置邮件头信息</span>
mail_body <span class="token operator">=</span> <span class="token triple-quoted-string string">'''
    &lt;h5>hello,⼩哥哥&lt;/h5>
    &lt;p>
    你好同学
    &lt;p>&lt;img src="cid:image1">&lt;/p>
    &lt;/p>
'''</span>
msg_root <span class="token operator">=</span> MIMEMultipart<span class="token punctuation">(</span><span class="token string">'related'</span><span class="token punctuation">)</span> <span class="token comment"># 允许添加附件、图⽚等</span>
msg_root<span class="token punctuation">[</span><span class="token string">"From"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"来⾃娜美的问候"</span><span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token comment"># 发送者</span>
msg_root<span class="token punctuation">[</span><span class="token string">"To"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"有缘⼈"</span><span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token comment"># 接收者</span>
msg_root<span class="token punctuation">[</span><span class="token string">"Subject"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"娜美的信"</span><span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token comment"># 主题</span>
<span class="token comment"># 允许添加图⽚</span>
msgAlternative <span class="token operator">=</span> MIMEMultipart<span class="token punctuation">(</span><span class="token string">'alternative'</span><span class="token punctuation">)</span>
msgAlternative<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>MIMEText<span class="token punctuation">(</span>mail_body<span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
msg_root<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>msgAlternative<span class="token punctuation">)</span> <span class="token comment"># 把邮件正⽂内容添加到msg_root⾥</span>
<span class="token comment"># 加载图⽚，</span>
fp <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'girl.jpg'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>
msgImage <span class="token operator">=</span> MIMEImage<span class="token punctuation">(</span>fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 定义图⽚ ID，在 HTML ⽂本中引⽤</span>
msgImage<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">'Content-ID'</span><span class="token punctuation">,</span> <span class="token string">'&lt;image1>'</span><span class="token punctuation">)</span>
msg_root<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>msgImage<span class="token punctuation">)</span> <span class="token comment"># 添加图⽚到msg_root对象⾥</span>
<span class="token comment"># 发送</span>
smtp_obj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span><span class="token string">"nami@luffycity.com"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"alex@luffycity.com"</span><span class="token punctuation">,</span>
<span class="token string">"317828332@qq.com"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msg_root<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<h1 id="实战：给员工自动批量发工资条"><a href="#实战：给员工自动批量发工资条" class="headerlink" title="实战：给员工自动批量发工资条"></a>实战：给员工自动批量发工资条</h1><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook

<span class="token keyword">import</span> smtplib
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText  <span class="token comment"># 构造邮件正文</span>
<span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> Header  <span class="token comment"># 邮件头</span>


<span class="token comment"># 1、登录邮件服务器</span>
smtp_obj <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP_SSL<span class="token punctuation">(</span><span class="token string">"smtp.qq.com"</span><span class="token punctuation">,</span> <span class="token number">465</span><span class="token punctuation">)</span>  <span class="token comment"># 发件⼈邮箱中的SMTP服务器，端⼝是25</span>
smtp_obj<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token string">"xxxxxxxx@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"xxxxxxxxxxx"</span><span class="token punctuation">)</span>  <span class="token comment"># 括号中对应的是发件⼈邮箱账号、授权码</span>
<span class="token comment"># smtp_obj.set_debuglevel(1) # 显示调试信息</span>

<span class="token comment"># 2、构造邮件表格</span>
wb <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span><span class="token string">'工资信息.xlsx'</span><span class="token punctuation">,</span> data_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 打开已有excel,data_only表示不转入公式</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active  <span class="token comment"># 激活当前sheet</span>

count_col <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>max_row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>count_col<span class="token punctuation">)</span>
    <span class="token comment"># 构造表头</span>
    <span class="token keyword">if</span> count_col <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        table_head <span class="token operator">=</span> <span class="token string">'&lt;thead>'</span>  <span class="token comment"># 表头用td</span>
        <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
            table_head <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f'&lt;th> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">&#125;</span></span><span class="token string"> &lt;/th>'</span></span>
        table_head <span class="token operator">+=</span> <span class="token string">'&lt;/thead>'</span>
        count_col <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token comment"># print(table_head)  # 显示拼接结果</span>
        <span class="token keyword">continue</span>  <span class="token comment"># 表头不发送</span>


    <span class="token comment"># 构造表格中其它行</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># print(row[2].value)</span>
        name <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value  <span class="token comment"># 将变量name储存用于文件头的收件人</span>
        email <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value  <span class="token comment"># 将变量email储存用于填写发送地址</span>
        table_row <span class="token operator">=</span> <span class="token string">'&lt;tbody>'</span>
        <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
            table_row <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f'&lt;td> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">&#125;</span></span><span class="token string"> &lt;/td>'</span></span>
        table_row <span class="token operator">+=</span> <span class="token string">'&lt;/tbody>'</span>
        <span class="token comment"># print(table_row)  # 显示拼接结果</span>

    <span class="token comment"># 3、构造邮件正文</span>
    msg <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'''
    &lt;h5>这是你的工资：&lt;/h5>
    &lt;table border="1">
        </span><span class="token interpolation"><span class="token punctuation">&#123;</span>table_head<span class="token punctuation">&#125;</span></span><span class="token string">
        </span><span class="token interpolation"><span class="token punctuation">&#123;</span>table_row<span class="token punctuation">&#125;</span></span><span class="token string">
    &lt;/table>

    '''</span></span>

    <span class="token comment"># 4、设置邮件头信息</span>
    msg <span class="token operator">=</span> MIMEText<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token string">"html"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># plain表示文件内容为纯文本</span>
    msg<span class="token punctuation">[</span><span class="token string">"From"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"耿天霸"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># 发送者</span>
    msg<span class="token punctuation">[</span><span class="token string">"To"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># 接收者</span>
    msg<span class="token punctuation">[</span><span class="token string">"Subject"</span><span class="token punctuation">]</span> <span class="token operator">=</span> Header<span class="token punctuation">(</span><span class="token string">"工资单"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>  <span class="token comment"># 主题</span>
    <span class="token comment"># print(name)</span>
    <span class="token comment"># print(email)</span>

    <span class="token comment"># 5、发送</span>
    smtp_obj<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span><span class="token string">"xxxxxxxx@qq.com"</span><span class="token punctuation">,</span> email<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token string">邮件已发送成功'</span></span><span class="token punctuation">)</span>

    count_col <span class="token operator">+=</span> <span class="token number">1</span></code></pre>
<h1 id="实战：批量从1000号员工word简历中调取技能关键词"><a href="#实战：批量从1000号员工word简历中调取技能关键词" class="headerlink" title="实战：批量从1000号员工word简历中调取技能关键词"></a>实战：批量从1000号员工word简历中调取技能关键词</h1><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> docx


<span class="token keyword">def</span> <span class="token function">get_ket_words</span><span class="token punctuation">(</span>key_list<span class="token punctuation">,</span> file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''

    :param key_list: 需要调取的技能列表['Python', '数据分析', '英语六级']
    :param file_path:  包含简历文件夹的绝对路径
    :return: 返回包含所选关键词的word文档列表['xxx简历.docx', 'xx简历.docx']
    '''</span>

    words_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># 获取路径下所有word文档</span>
    file_list <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">file</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'docx'</span><span class="token punctuation">:</span>
            words_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    <span class="token comment"># print(words_list)</span>

    text_dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token comment"># &#123;word文件路径: 'word文字内容'&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> words_list<span class="token punctuation">:</span>
        word_name <span class="token operator">=</span> file_path<span class="token operator">+</span> <span class="token string">'\\'</span> <span class="token operator">+</span> word
        document <span class="token operator">=</span> docx<span class="token punctuation">.</span>Document<span class="token punctuation">(</span>word_name<span class="token punctuation">)</span>
        all_paragraphs <span class="token operator">=</span> document<span class="token punctuation">.</span>paragraphs
        word_text <span class="token operator">=</span> <span class="token string">''</span>
        <span class="token keyword">for</span> paragraph <span class="token keyword">in</span> all_paragraphs<span class="token punctuation">:</span>
            word_text <span class="token operator">+=</span> paragraph<span class="token punctuation">.</span>text
        text_dic<span class="token punctuation">[</span>word_name<span class="token punctuation">]</span> <span class="token operator">=</span> word_text
    <span class="token comment"># print(text_dic)</span>

    out_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> text <span class="token keyword">in</span> text_dic<span class="token punctuation">:</span>
        <span class="token keyword">for</span> key <span class="token keyword">in</span> key_list<span class="token punctuation">:</span>
            <span class="token keyword">if</span> key <span class="token keyword">in</span> text_dic<span class="token punctuation">[</span>text<span class="token punctuation">]</span><span class="token punctuation">:</span>
                out_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>text<span class="token punctuation">)</span>

    <span class="token keyword">return</span> out_list


file_path <span class="token operator">=</span> <span class="token string">r'C:\Users\Geng\Desktop\我在b站学编程\python\day6\简历'</span>
out_list <span class="token operator">=</span> get_ket_words<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Python'</span><span class="token punctuation">,</span> <span class="token string">'数据分析'</span><span class="token punctuation">,</span> <span class="token string">'英语六级'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> file_path<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>out_list<span class="token punctuation">)</span></code></pre>
<p>※ 目前只能实现纯文本word的读取</p>
<h1 id="作业：生成1000张名字不同的学员海报"><a href="#作业：生成1000张名字不同的学员海报" class="headerlink" title="作业：生成1000张名字不同的学员海报"></a>作业：生成1000张名字不同的学员海报</h1>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Gengtianba</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://gengtianba.github.io/2022/05/14/Python%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A6/">https://gengtianba.github.io/2022/05/14/Python%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A6/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Gengtianba</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Python/">
                                    <span class="chip bg-color">Python</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/05/19/Python%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A7/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="day7-Web开发初探">
                        
                        <span class="card-title">day7-Web开发初探</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            本文章为金角大王Alex《Python零基础到精通7天速成》视频笔记视频链接:Python零基础到精通7天速成
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-05-19
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Gengtianba
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/05/11/Python%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A5/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="day5-函数编程">
                        
                        <span class="card-title">day5-函数编程</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            本文章为金角大王Alex《Python零基础到精通7天速成》视频笔记视频链接:Python零基础到精通7天速成
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-05-11
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Gengtianba
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">Gengtianba</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
